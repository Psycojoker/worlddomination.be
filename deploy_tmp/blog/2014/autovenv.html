

<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

	<head>

		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<title>
			
			WorldDomination.be : blog : Some tips for autoenv
			
		</title>

		

		<link href="/blog/atom.xml" rel="alternate" title="WorldDomination.be" type="application/atom+xml"/>

		

		

		<link rel="stylesheet" href="/media/css/base.css" type="text/css" media="screen" charset="utf-8">

		
		
		
		
		
		

		
		
		
		

	</head>

	<body>

		<div id="site">	

			<div id="header">
    <a href="/index.html">
        <h1>WorldDomination.be</h1>
    </a>
    <p>A blog about my mess</p>
</div>




<ul class="breadcrumbs">
	
		<li>
			<a href="/index.html">Worlddominationbe</a>

			
				
				<span class="separator">&gt;</span>
				
			
		</li>
	
		<li>
			<a href="/blog/blog.html">Blog</a>

			
				
				<span class="separator">&gt;</span>
				
			
		</li>
	
		<li>
			<a href="/blog/2014/2014.html">2014</a>

			
		</li>
	
</ul>
    









<div id="sitenav">
    <ul>
        <li>
            <a href="/index.html">Home</a>
        </li>

        
            <li class="selected" >
                <a href="/blog/blog.html">
                    Blog
                </a>
            </li>
        
            <li>
                <a href="/about/about.html">
                    About
                </a>
            </li>
        
    </ul>
</div>





			



<div id="content-header">
    <h1>Some tips for autoenv</h1>
</div>

<div id="post-content">
	

	<!-- Hyde::Article::Begin -->

<!-- Hyde::Excerpt::Begin -->

<p>I've finally took the time to test
<a href="https://github.com/kennethreitz/autoenv">autoenv</a> by kenneth. It's a very nice
piece of software that allow the automatic execution of the content of a
<code>.env</code> file if present in the current directory <strong>or</strong> in a
directory above. It is very usefull to auto activate virtualenv or those kind
of similar&nbsp;actions.</p>
<p>It also comes with security mechanism (it asks you to accept a .env file if
it's the first time you saw it and store an hash of&nbsp;it).</p>
<p>The <a href="https://github.com/kennethreitz/autoenv#install">installation instructions</a> and <a href="https://github.com/kennethreitz/autoenv#usage">usage informations</a> are clear enough so I won't write about it, but I wanted to share 2 small&nbsp;tips:</p>
<h2>Deadline with the "in above directory"&nbsp;case</h2>
<p>Autovenv also work when the <code>.env</code> is located in a directory above,
the problem is that the <code>CWD</code> passed to the script is the current
one and not the one in which the <code>.env</code> file exists. Therefor, just
dropping <code>source ve/bin/activate</code> (assuming your virtualenv is
called <code>ve</code>) won't work&nbsp;everywhere.</p>
<p>Here is how to get the directory in which the file is in <a href="http://www.zsh.org/">zsh</a>:</p>
<div class="highlight"><pre><span class="k">${</span><span class="nv">0</span><span class="p">%/*</span><span class="k">}</span><span class="o">)</span>
</pre></div>

<p>Therefor, you can write this in your .env&nbsp;file:</p>
<div class="highlight"><pre><span class="c">#!/bin/zsh</span>
<span class="o">[</span> -e <span class="s2">&quot;$(/bin/readlink -f ${0%/*})/ve/bin/activate&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> <span class="k">$(</span>/bin/readlink -f <span class="k">${</span><span class="nv">0</span><span class="p">%/*</span><span class="k">})</span>/ve/bin/activate
</pre></div>

<h2>Auto install for the&nbsp;lazy</h2>
<p>You have several computers, your dotfiles are synced but you don't want to care about remembering of installing <code>autoenv</code> everywhere? Just drop this line in your <code>~/.zshrc</code> (should be working for bash&nbsp;to):</p>
<div class="highlight"><pre><span class="o">[</span> -e <span class="nv">$HOME</span>/.local/bin/activate.sh <span class="o">]</span> <span class="o">||</span> <span class="o">(</span>pip install --user autoenv<span class="o">)</span>

<span class="c"># if you don&#39;t have it already, put this line after</span>
<span class="nb">source</span> <span class="nv">$HOME</span>/.local/bin/activate.sh
</pre></div>

<p>This will install <code>autoenv</code>, if it's not already installed, the next time you launch a&nbsp;shell.</p>
<!-- Hyde::Excerpt::End -->

<!-- Hyde::Article::End -->

	
</div>





			<div id='footer'>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</div>


		</div>

	</body>

</html>

